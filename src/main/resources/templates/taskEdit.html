<!DOCTYPE html>
<html lang="ja">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta http-equiv="X-UA-Compatible" content="ie=edge" />
	<title>ToDo</title>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css" />
	<link rel="stylesheet" th:href="@{/app.css}" type="text/css">
</head>

<body>
	<header class="mb-5">
		<nav class="navbar navbar-light bg-light">
			<a href="/" class="navbar-brand">ToDo</a>
		</nav>
	</header>
	<main>
		<div class="todo-container">
			<h1 class="h3 mb-4">タスク編集</h1>

			<table class="table table-bordered mb-3">
				<thead>
					<tr>
						<th>状態</th>
						<th>タスク</th>
						<th>期限</th>
						<th>確定</th>
						<th>状態変更</th>
						<th>削除</th>

					</tr>
				</thead>
				<tbody>
					<tr th:each="task:${tasks}" th:object="${task}">

						<td class="text-center">
							<span th:class="'badge badge-pill '  + (*{status} ?  'badge-success' : 'badge-light')"
								th:text="*{status} ?  '完了' : '未完了'"></span>
						</td>
						<form action="/editPost" th:object="${task}" method="post">
							<td>
								<input class="form-control" type="text" name="task" th:value="*{task}" />
								<div class="text-danger" th:if="${#fields.hasErrors('task')}" th:errors="*{task}"></div>
							</td>
							<td>
								<input class="form-control" type="date" name="due" th:value="*{due}" />
<!--								<div class="text-danger" th:if="${#fields.hasErrors('due')}" th:errors="*{due}"></div>-->
							</td>
							<td>
								<input type="hidden" name="id" th:value="*{id}">
								<input type="hidden" name="status" th:value="*{status}">
								<button class="btn btn-sm btn-primary" type="submit">確定</button>
							</td>
						</form>
						<td>
							<th:block th:if="*{!status}">
								-
							</th:block>
							<th:block th:if="*{status}">
								<form action="/taskUpdate" method="post">
									<input type="hidden" name="id" th:value="*{id}">
									<input type="hidden" name="status" value="False">
									<input type="hidden" name="page" value="taskEdit">
									<button class="btn btn-sm btn-primary" type="submit">未完了にする</button>
								</form>
							</th:block>
						</td>
						<td>
							<form action="/deletePost" method="post">
								<input type="hidden" name="id" th:value="*{id}">
								<button class="btn btn-sm btn-primary" type="submit">削除する</button>
							</form>
						</td>
					</tr>
				</tbody>
			</table>
			<form action="/editPost" th:object="${task}" method="post">
				<div class="d-flex justify-content-between align-items-center">
					<a href="/" class="btn btn-outline-primary">戻る</a>
				</div>
			</form>
		</div>
	</main>
</body>

</html>